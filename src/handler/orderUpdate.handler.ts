import { EventEmitter } from "events"
import chatter from "../events"
export default async function (userId: string, data: any) {
	if (typeof data == "undefined") return
	chatter.emit("fyersOrderUpdateSocket", "", { ...data, userId })
	if (data.message == "TRADE_CONFIRMED") {
		const preparedData = {
			userId: userId,
			orderUpdateData: {
				symbol: data.symbol,
				orderID: data.id,
				side: data.side,
				quantity: data.qty,
				remainingQuantity: data.remainingQuantity,
				filledQuantity: data.filledQty,
				status: data.status,
				segment: data.segment,
				limitPrice: data.limitPrice,
				stopPrice: data.stopPrice,
				type: data.type,
				slNo: data.slNo,
				message: data.message,
				orderNumStatus: data.orderNumStatus,
				tradedPrice: data.tradedPrice,
			},
		}
		console.log(preparedData)
		chatter.emit("fyersOrderHandler-", "orderUpdate", preparedData)
	}
}
// {
// 	orderDateTime: 1690880114,
// 	id: '23080100341336',
// 	exchOrdId: '23080100341336',
// 	side: 1,
// 	segment: 'D',
// 	instrument: '',
// 	productType: 'INTRADAY',
// 	status: 6,
// 	qty: 15,
// 	remainingQuantity: 15,
// 	filledQty: 0,
// 	limitPrice: 160,
// 	stopPrice: 0,
// 	type: 1,
// 	discloseQty: 0,
// 	dqQtyRem: 0,
// 	orderValidity: 'DAY',
// 	slNo: 1,
// 	offlineOrder: false,
// 	message: 'New',
// 	orderNumStatus: '23080100341336:6',
// 	tradedPrice: 0,
// 	fyToken: '101123080343572',
// 	symbol: 'NSE:BANKNIFTY2380345600CE'
//   }
//   {
// 	orderDateTime: 1690880126,
// 	id: '23080100341336',
// 	exchOrdId: '23080100341336',
// 	side: 1,
// 	segment: 'D',
// 	instrument: '',
// 	productType: 'INTRADAY',
// 	status: 1,
// 	qty: 15,
// 	remainingQuantity: 0,
// 	filledQty: 0,
// 	limitPrice: 160,
// 	stopPrice: 0,
// 	type: 1,
// 	discloseQty: 0,
// 	dqQtyRem: 0,
// 	orderValidity: 'DAY',
// 	slNo: 1,
// 	offlineOrder: false,
// 	message: 'Cancelled',
// 	orderNumStatus: '23080100341336:1',
// 	tradedPrice: 0,
// 	fyToken: '101123080343572',
// 	symbol: 'NSE:BANKNIFTY2380345600CE'
//   }
// {
// 	orderDateTime: 1690880232,
// 	id: '23080100343764',
// 	exchOrdId: '23080100343764',
// 	side: 1,
// 	segment: 'D',
// 	instrument: '',
// 	productType: 'INTRADAY',
// 	status: 2,
// 	qty: 90,
// 	remainingQuantity: 0,
// 	filledQty: 90,
// 	limitPrice: 183.75,
// 	stopPrice: 0,
// 	type: 2,
// 	discloseQty: 0,
// 	dqQtyRem: 0,
// 	orderValidity: 'DAY',
// 	slNo: 2,
// 	offlineOrder: false,
// 	message: 'TRADE_CONFIRMED',
// 	orderNumStatus: '23080100343764:2',
// 	tradedPrice: 183.75,
// 	fyToken: '101123080343573',
// 	symbol: 'NSE:BANKNIFTY2380345600PE'
//   }
// {
// 	orderDateTime: 1690880319,
// 	id: '23080100345150',
// 	exchOrdId: '23080100345150',
// 	side: 1,
// 	segment: 'D',
// 	instrument: '',
// 	productType: 'INTRADAY',
// 	status: 6,
// 	qty: 90,
// 	remainingQuantity: 90,
// 	filledQty: 0,
// 	limitPrice: 170,
// 	stopPrice: 0,
// 	type: 1,
// 	discloseQty: 0,
// 	dqQtyRem: 0,
// 	orderValidity: 'DAY',
// 	slNo: 1,
// 	offlineOrder: false,
// 	message: 'New',
// 	orderNumStatus: '23080100345150:6',
// 	tradedPrice: 0,
// 	fyToken: '101123080343572',
// 	symbol: 'NSE:BANKNIFTY2380345600CE'
//   }

// {
// 	orderDateTime: 1690880375,
// 	id: '23080100346766',
// 	exchOrdId: '23080100346766',
// 	side: -1,
// 	segment: 'D',
// 	instrument: '',
// 	productType: 'INTRADAY',
// 	status: 6,
// 	qty: 90,
// 	remainingQuantity: 15,
// 	filledQty: 75,
// 	limitPrice: 170.65,
// 	stopPrice: 0,
// 	type: 2,
// 	discloseQty: 0,
// 	dqQtyRem: 0,
// 	orderValidity: 'DAY',
// 	slNo: 2,
// 	offlineOrder: false,
// 	message: 'TRADE_CONFIRMED',
// 	orderNumStatus: '23080100346766:6',
// 	tradedPrice: 170.65,
// 	fyToken: '101123080343573',
// 	symbol: 'NSE:BANKNIFTY2380345600PE'
//   }
//   {
// 	orderDateTime: 1690880375,
// 	id: '23080100346766',
// 	exchOrdId: '23080100346766',
// 	side: -1,
// 	segment: 'D',
// 	instrument: '',
// 	productType: 'INTRADAY',
// 	status: 6,
// 	qty: 90,
// 	remainingQuantity: 75,
// 	filledQty: 15,
// 	limitPrice: 170.65,
// 	stopPrice: 0,
// 	type: 2,
// 	discloseQty: 0,
// 	dqQtyRem: 0,
// 	orderValidity: 'DAY',
// 	slNo: 2,
// 	offlineOrder: false,
// 	message: 'TRADE_CONFIRMED',
// 	orderNumStatus: '23080100346766:6',
// 	tradedPrice: 170.65,
// 	fyToken: '101123080343573',
// 	symbol: 'NSE:BANKNIFTY2380345600PE'
//   }
//   {
// 	orderDateTime: 1690880375,
// 	id: '23080100346766',
// 	exchOrdId: '23080100346766',
// 	side: -1,
// 	segment: 'D',
// 	instrument: '',
// 	productType: 'INTRADAY',
// 	status: 2,
// 	qty: 90,
// 	remainingQuantity: 0,
// 	filledQty: 90,
// 	limitPrice: 170.65,
// 	stopPrice: 0,
// 	type: 2,
// 	discloseQty: 0,
// 	dqQtyRem: 0,
// 	orderValidity: 'DAY',
// 	slNo: 2,
// 	offlineOrder: false,
// 	message: 'TRADE_CONFIRMED',
// 	orderNumStatus: '23080100346766:2',
// 	tradedPrice: 170.65,
// 	fyToken: '101123080343573',
// 	symbol: 'NSE:BANKNIFTY2380345600PE'
//   }
